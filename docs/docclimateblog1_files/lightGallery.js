(function(e){"use strict";e.fn.lightGallery=function(t){var n={mode:"slide",useCSS:true,easing:"linear",speed:1e3,start:0,loop:false,auto:false,pause:4e3,escKey:true,rel:false,lang:{allPhotos:"All photos"},exThumbImage:false,thumbnail:true,caption:false,captionLink:false,desc:false,counter:false,controls:true,hideControlOnEnd:false,mobileSrc:false,mobileSrcMaxWidth:640,swipeThreshold:50,vimeoColor:"CCCCCC",videoAutoplay:true,videoMaxWidth:855,dynamic:false,dynamicEl:[],onOpen:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){},onBeforeClose:function(){},onCloseAfter:function(){}},r=e(this),i,s,o=false,u='<div id="lightGallery-outer"><div id="lightGallery-Gallery"><div id="lightGallery-slider"></div><a id="lightGallery-close" class="close"></a></div></div>',a=document.createTouch!==undefined||"ontouchstart"in window||"onmsgesturechange"in window||navigator.msMaxTouchPoints,f,l,c,h,p,d,v,m,g,y,b,w=false,E=false,S=false;var x=e.extend(true,{},n,t);var T={init:function(){r.each(function(){var t=e(this);if(x.dynamic==true){i=x.dynamicEl;s=x.start;v=s;N.init(s)}else{i=e(this).children();i.click(function(n){if(x.rel==true&&t.data("rel")){var r=t.data("rel");i=e('[data-rel="'+r+'"]').children()}else{i=t.children()}n.preventDefault();n.stopPropagation();s=i.index(this);v=s;N.init(s)})}})}};var N={init:function(){this.start();this.build()},start:function(){this.structure();this.getWidth();this.closeSlide()},build:function(){this.loadContent(s);this.addCaption();this.addDesc();this.counter();this.slideTo();this.buildThumbnail();this.keyPress();this.slide(s);this.touch();this.enableTouch();setTimeout(function(){f.addClass("opacity")},50)},structure:function(){e("body").append(u).addClass("lightGallery");l=e("#lightGallery-outer");f=e("#lightGallery-Gallery");c=f.find("#lightGallery-slider");var t="";if(x.dynamic==true){for(var n=0;n<x.dynamicEl.length;n++){t+='<div class="lightGallery-slide"></div>'}}else{i.each(function(){t+='<div class="lightGallery-slide"></div>'})}c.append(t);h=f.find(".lightGallery-slide")},closeSlide:function(){var t=this;e("#lightGallery-close").bind("click touchend",function(){t.destroy()})},getWidth:function(){var t=function(){y=e(window).width()};e(window).bind("resize.lightGallery",t())},doCss:function(){var e=function(){var e=["transition","MozTransition","WebkitTransition","OTransition","msTransition","KhtmlTransition"];var t=document.documentElement;for(var n=0;n<e.length;n++){if(e[n]in t.style){return true}}};if(x.useCSS&&e()){return true}return false},enableTouch:function(){var t=this;if(a){var n={},r={};e("body").on("touchstart.lightGallery",function(e){r=e.originalEvent.targetTouches[0];n.pageX=e.originalEvent.targetTouches[0].pageX;n.pageY=e.originalEvent.targetTouches[0].pageY});e("body").on("touchmove.lightGallery",function(e){var t=e.originalEvent;r=t.targetTouches[0];e.preventDefault()});e("body").on("touchend.lightGallery",function(e){var i=r.pageX-n.pageX,s=x.swipeThreshold;if(i>=s){t.prevSlide();clearInterval(b)}else if(i<=-s){t.nextSlide();clearInterval(b)}})}},touch:function(){var t,n;var r=this;e(".lightGallery").bind("mousedown",function(e){e.stopPropagation();e.preventDefault();t=e.pageX});e(".lightGallery").bind("mouseup",function(e){e.stopPropagation();e.preventDefault();n=e.pageX;if(n-t>20){r.prevSlide()}else if(t-n>20){r.nextSlide()}})},isVideo:function(e){var t=e.match(/youtube\.com\/watch\?v=([a-zA-Z0-9\-_]+)/);var n=e.match(/vimeo\.com\/([0-9]*)/);if(t||n){return true}},loadVideo:function(e,t,n){var r=e.match(/watch\?v=([a-zA-Z0-9\-_]+)/);var i=e.match(/vimeo\.com\/([0-9]*)/);var s="";if(r){if(x.videoAutoplay===true&&t===true){t="?autoplay=1&rel=0&wmode=opaque"}else{t="?wmode=opaque"}s='<iframe id="video'+n+'" width="560" height="315" src="//www.youtube.com/embed/'+r[1]+t+'" frameborder="0" allowfullscreen></iframe>'}else if(i){if(x.videoAutoplay===true&&t===true){t="autoplay=1&"}else{t=""}s='<iframe id="video'+n+'" width="560" height="315"  src="http://player.vimeo.com/video/'+i[1]+"?"+t+"byline=0&portrait=0&color="+x.vimeoColor+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}return'<div class="video_cont" style="max-width:'+x.videoMaxWidth+'px !important;"><div class="video">'+s+"</div></div>"},loadContent:function(t){var n=this;var r,s,o,u=i.length-t;var a;n.autoStart();if(x.mobileSrc===true&&y<=x.mobileSrcMaxWidth){if(x.dynamic==true){a=x.dynamicEl[t]["mobileSrc"]}else{a=i.eq(t).attr("data-responsive-src")}}else{if(x.dynamic==true){a=x.dynamicEl[t]["src"]}else{a=i.eq(t).attr("data-src")}}if(!n.isVideo(a)){h.eq(t).prepend('<img src="'+a+'" />');o=e("img")}else{h.eq(t).prepend(n.loadVideo(a,true,t));o=e("iframe");if(x.auto&&x.videoAutoplay===true){clearInterval(b)}}if(i.length>1){h.eq(t).find(o).on("load error",function(){for(r=0;r<=t-1;r++){var e;if(x.mobileSrc===true&&y<=x.mobileSrcMaxWidth){if(x.dynamic==true){e=x.dynamicEl[t-r-1]["mobileSrc"]}else{e=i.eq(t-r-1).attr("data-responsive-src")}}else{if(x.dynamic==true){e=x.dynamicEl[t-r-1]["src"]}else{e=i.eq(t-r-1).attr("data-src")}}if(!n.isVideo(e)){h.eq(t-r-1).prepend('<img src="'+e+'" />')}else{h.eq(t-r-1).prepend(n.loadVideo(e,false,t-r-1))}}for(s=1;s<u;s++){var e;if(x.mobileSrc===true&&y<=x.mobileSrcMaxWidth){if(x.dynamic==true){e=x.dynamicEl[t+s]["mobileSrc"]}else{e=i.eq(t+s).attr("data-responsive-src")}}else{if(x.dynamic==true){e=x.dynamicEl[t+s]["src"]}else{e=i.eq(t+s).attr("data-src")}}if(!n.isVideo(e)){h.eq(t+s).prepend('<img src="'+e+'" />')}else{h.eq(t+s).prepend(n.loadVideo(e,false,t+s))}}})}},addCaption:function(){if(x.caption===true){var e,t=false;for(e=0;e<i.length;e++){if(x.dynamic==true){t=x.dynamicEl[e]["caption"]}else{t=i.eq(e).attr("data-title")}if(typeof t=="undefined"||t==null){t="image "+e+""}if(x.captionLink===true){var n=i.eq(e).attr("data-link");if(typeof n!=="undefined"&&n!==""){n=n}else{n="#"}h.eq(e).append('<div class="info group"><a href="'+n+'" class="title">'+t+"</a></div>")}else{h.eq(e).append('<div class="info group"><span class="title">'+t+"</span></div>")}}}},addDesc:function(){if(x.desc===true){var e,t=false;for(e=0;e<i.length;e++){if(x.dynamic==true){t=x.dynamicEl[e]["desc"]}else{t=i.eq(e).attr("data-desc");}if(typeof t=="undefined"||t==null){t="image "+e+""}if(x.caption===false){h.eq(e).append('<div class="info group"><span class="desc">'+t+"</span></div>")}else{h.eq(e).find(".info").append('<span class="desc">'+t+"</span>")}}}},counter:function(){if(x.counter===true){var t=e("#lightGallery-slider > div").length;f.append("<div id='lightGallery_counter'><span id='lightGallery_counter_current'></span> / <span id='lightGallery_counter_all'>"+t+"</span></div>")}},buildThumbnail:function(){if(x.thumbnail===true&&i.length>1){var t=this;f.append('<div class="thumb_cont"><div class="thumb_info"><span class="close ib"><i class="bUi-iCn-rMv-16" aria-hidden="true"></i></span></div><div class="thumb_inner"></div></div>');m=f.find(".thumb_cont");p.after('<a class="cLthumb"></a>');f.find(".cLthumb").bind("click touchend",function(){m.addClass("open");if(t.doCss()&&x.mode==="slide"){h.eq(s).prevAll().removeClass("nextSlide").addClass("prevSlide");h.eq(s).nextAll().removeClass("prevSlide").addClass("nextSlide")}});f.find(".close").bind("click touchend",function(){m.removeClass("open")});var n=f.find(".thumb_info");var r=f.find(".thumb_inner");var o="";var u;if(x.dynamic==true){for(var a=0;a<x.dynamicEl.length;a++){u=x.dynamicEl[a]["thumb"];o+='<div class="thumb"><img src="'+u+'" /></div>'}}else{i.each(function(){if(x.exThumbImage===false||typeof e(this).attr(x.exThumbImage)=="undefined"||e(this).attr(x.exThumbImage)==null){u=e(this).find("img").attr("src")}else{u=e(this).attr(x.exThumbImage)}o+='<div class="thumb"><img src="'+u+'" /></div>'})}r.append(o);g=r.find(".thumb");g.bind("click touchend",function(){w=true;var n=e(this).index();g.removeClass("active");e(this).addClass("active");t.slide(n);clearInterval(b)});n.prepend('<span class="ib count">'+x.lang.allPhotos+" ("+g.length+")</span>")}},slideTo:function(){var e=this;if(x.controls===true&&i.length>1){f.append('<div id="lightGallery-action"><a id="lightGallery-prev"></a><a id="lightGallery-next"></a></div>');p=f.find("#lightGallery-prev");d=f.find("#lightGallery-next");p.bind("click",function(){e.prevSlide();clearInterval(b)});d.bind("click",function(){e.nextSlide();clearInterval(b)})}},autoStart:function(){var e=this;if(x.auto===true){b=setInterval(function(){if(s+1<i.length){s=s}else{s=-1}s++;e.slide(s)},x.pause)}},keyPress:function(){var t=this;e(window).bind("keyup.lightGallery",function(e){e.preventDefault();e.stopPropagation();if(e.keyCode===37){t.prevSlide();clearInterval(b)}if(e.keyCode===38&&x.thumbnail===true){if(!m.hasClass("open")){if(t.doCss()&&x.mode==="slide"){h.eq(s).prevAll().removeClass("nextSlide").addClass("prevSlide");h.eq(s).nextAll().removeClass("prevSlide").addClass("nextSlide")}m.addClass("open")}}else if(e.keyCode===39){t.nextSlide();clearInterval(b)}if(e.keyCode===40&&x.thumbnail===true){if(m.hasClass("open")){m.removeClass("open")}}else if(x.escKey===true&&e.keyCode===27){if(x.thumbnail===true&&m.hasClass("open")){m.removeClass("open")}else{t.destroy()}}})},nextSlide:function(){var e=this;s=h.index(h.eq(v));if(s+1<i.length){s++;e.slide(s)}else{if(x.loop){s=0;e.slide(s)}else if(x.mode==="fade"&&x.thumbnail===true&&i.length>1){m.addClass("open")}}x.onSlideNext.call(this)},prevSlide:function(){var e=this;s=h.index(h.eq(v));if(s>0){s--;e.slide(s)}else{if(x.loop){s=i.length-1;e.slide(s)}else if(x.mode==="fade"&&x.thumbnail===true&&i.length>1){m.addClass("open")}}x.onSlidePrev.call(this)},slide:function(t){if(o){if(!c.hasClass("on")){c.addClass("on")}if(this.doCss()&&x.speed!==""){if(!c.hasClass("speed")){c.addClass("speed")}if(S===false){c.css("transition-duration",x.speed+"ms");S=true}}if(this.doCss()&&x.easing!==""){if(!c.hasClass("timing")){c.addClass("timing")}if(E===false){c.css("transition-timing-function",x.easing);E=true}}x.onSlideBefore.call(this)}if(x.mode==="slide"){if(this.doCss()&&!c.hasClass("slide")){c.addClass("slide")}if(!this.doCss()&&!o){c.css({left:-t*100+"%"})}else if(!this.doCss()&&o){c.animate({left:-t*100+"%"},x.speed,x.easing)}}else if(x.mode==="fade"){if(this.doCss()&&!c.hasClass("fadeM")){c.addClass("fadeM")}else if(!this.doCss()&&!c.hasClass("animate")){c.addClass("animate")}if(!this.doCss()&&!o){h.fadeOut(100);h.eq(t).fadeIn(100)}else if(!this.doCss()&&o){h.eq(v).fadeOut(x.speed,x.easing);h.eq(t).fadeIn(x.speed,x.easing)}}if(t+1>=i.length&&x.auto&&x.loop===false){clearInterval(b)}h.eq(v).removeClass("current");h.eq(t).addClass("current");if(this.doCss()&&x.mode==="slide"){if(w===false){e(".prevSlide").removeClass("prevSlide");e(".nextSlide").removeClass("nextSlide");h.eq(t-1).addClass("prevSlide");h.eq(t+1).addClass("nextSlide")}else{h.eq(t).prevAll().removeClass("nextSlide").addClass("prevSlide");h.eq(t).nextAll().removeClass("prevSlide").addClass("nextSlide")}}if(x.thumbnail===true&&i.length>1){g.removeClass("active");g.eq(t).addClass("active")}if(x.controls&&x.hideControlOnEnd&&x.loop===false){if(t===0){p.addClass("disabled")}else if(t===i.length-1){d.addClass("disabled")}else{p.add(d).removeClass("disabled")}}v=t;o===false?x.onOpen.call(this):x.onSlideAfter.call(this);o=true;w=false;if(x.counter){e("#lightGallery_counter_current").text(t+1)}},destroy:function(){x.onBeforeClose.call(this);o=false;E=false;S=false;w=false;clearInterval(b);e(".lightGallery").off("mousedown mouseup");e("body").off("touchstart.lightGallery touchmove.lightGallery touchend.lightGallery");e(window).off("resize.lightGallery keyup.lightGallery");f.addClass("fadeM");setTimeout(function(){l.remove();e("body").removeClass("lightGallery")},500);x.onCloseAfter.call(this)}};T.init();return this}})(jQuery)